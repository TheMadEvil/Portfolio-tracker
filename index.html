<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Family Portfolio Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: #f4f8fb;
      font-family: Arial, sans-serif;
    }
    .card {
      border-radius: 1rem;
      margin-bottom: 1.5rem;
    }
    .dashboard {
      max-width: 900px;
      margin: auto;
      padding: 2rem;
    }
    .chart-container {
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <h2 class="text-center mb-4">ðŸ“Š Family Investment Dashboard</h2>

    <div class="row" id="portfolio-cards"></div>

    <div class="chart-container">
      <canvas id="portfolioChart"></canvas>
    </div>
  </div>

<script>
  const defaultData = {
    you: [
      { name: "Axis Liquid Fund", amount: 1026, return: 1.35 },
      { name: "Nippon Silver ETF FoF", amount: 3786, return: -3.79 },
      { name: "Nippon Large Cap", amount: 2914, return: -1.85 },
      { name: "Invesco PSU ETF", amount: 2500, return: 0 },
      { name: "Parag Parikh Flexi Cap", amount: 2500, return: 0 },
    ],
    spouse: [
      { name: "SBI Contra Regular", amount: 16247, return: 1.55 },
      { name: "SBI Large & Mid Regular", amount: 8371.95, return: 4.65 },
      { name: "SBI Small Cap Regular", amount: 16428, return: 2.68 },
    ],
  };

  // Load from localStorage or use default
  const data = JSON.parse(localStorage.getItem("portfolioData")) || defaultData;
  const allData = [...data.you, ...data.spouse];
  const container = document.getElementById("portfolio-cards");

  function makeEditable(span, key, field, obj) {
    span.contentEditable = true;
    span.addEventListener("blur", () => {
      obj[field] = parseFloat(span.innerText.replace(/[â‚¹,%]/g, "").trim()) || 0;
      localStorage.setItem("portfolioData", JSON.stringify(data));
      location.reload(); // refresh to update chart
    });
  }

  allData.forEach((fund, index) => {
    const card = document.createElement("div");
    card.className = "col-md-6";
    const color = ["primary", "success", "warning", "danger", "info"][index % 5];

    card.innerHTML = `
      <div class="card border-${color}">
        <div class="card-body">
          <h5 class="card-title">${fund.name}</h5>
          <p class="card-text">ðŸ’° Amount: â‚¹<span class="editable amount">${fund.amount}</span></p>
          <p class="card-text">ðŸ“ˆ Return: <span class="editable return">${fund.return >= 0 ? '+' : ''}${fund.return}</span>%</p>
        </div>
      </div>
    `;
    container.appendChild(card);

    // Enable editing
    const spans = card.querySelectorAll(".editable");
    makeEditable(spans[0], fund.name, "amount", fund);
    makeEditable(spans[1], fund.name, "return", fund);
  });

  const ctx = document.getElementById("portfolioChart").getContext("2d");
  new Chart(ctx, {
    type: "doughnut",
    data: {
      labels: allData.map(f => f.name),
      datasets: [{
        label: "Amount in â‚¹",
        data: allData.map(f => f.amount),
        backgroundColor: [
          "#4e79a7", "#f28e2b", "#e15759", "#76b7b2",
          "#59a14f", "#edc949", "#af7aa1", "#ff9da7",
          "#9c755f", "#bab0ab"
        ]
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: "bottom"
        },
        title: {
          display: true,
          text: "Portfolio Allocation"
        }
      }
    }
  });
</script>
</body>
</html>

